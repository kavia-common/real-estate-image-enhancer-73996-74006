{"is_source_file": true, "format": "TypeScript", "description": "This file is a client-side API utility for interacting with a FastAPI backend in a real estate image enhancement project. It defines types for data structures, handles authentication tokens, and provides functions for user registration, login, fetching dashboard data, image management, and subscription handling.", "external_files": ["fetch API (built-in)", "environment variables (process.env)", "localStorage"], "external_methods": ["fetch", "localStorage.getItem", "localStorage.setItem", "localStorage.removeItem"], "published": ["apiRegister", "apiLogin", "apiLogout", "apiDashboard", "apiListImages", "apiUploadImages", "apiGetImage", "apiRequestEdit", "apiEditHistory", "apiListSubscriptions", "apiCreateOrUpdateSubscription", "apiCreateCheckoutSession", "getStripePublicKey", "Token", "UserOut", "ImageOut", "EditHistoryOut", "UsageSummary", "SubscriptionOut", "DashboardSummary"], "classes": [], "methods": [{"name": "async function request<T>(path: string, options: RequestInit = {}, auth = false): Promise<T> { request", "description": "Generic function to make API requests with optional authentication and error handling.", "scope": "", "scopeKind": ""}, {"name": "export async function apiRegister(payload: { email: string; password: string; full_name?: string/ apiRegister", "description": "Registers a new user with email and password, and optionally full name.", "scope": "", "scopeKind": ""}, {"name": "export async function apiLogin(payload: { email: string; password: string }): Promise<Token> { apiLogin", "description": "Logs in a user with email and password, stores JWT token.", "scope": "", "scopeKind": ""}, {"name": "export function apiLogout(): void { apiLogout", "description": "Clears stored JWT token to log out the user.", "scope": "", "scopeKind": ""}, {"name": "export async function apiDashboard(): Promise<DashboardSummary> { apiDashboard", "description": "Fetches dashboard summary data including user info, usage, images, and subscriptions.", "scope": "", "scopeKind": ""}, {"name": "export async function apiListImages(): Promise<ImageOut[]> { apiListImages", "description": "Retrieves list of images uploaded by the current user.", "scope": "", "scopeKind": ""}, {"name": "export async function apiUploadImages(files: File[]): Promise<ImageOut[]> { apiUploadImages", "description": "Uploads multiple images via multipart/form-data.", "scope": "", "scopeKind": ""}, {"name": "export async function apiGetImage(image_id: number): Promise<ImageOut> { apiGetImage", "description": "Retrieves metadata for a specific image by ID.", "scope": "", "scopeKind": ""}, {"name": "export async function apiRequestEdit(image_id: number, prompt: string): Promise<EditHistoryOut> / apiRequestEdit", "description": "Creates a natural language edit request for an image.", "scope": "", "scopeKind": ""}, {"name": "export async function apiEditHistory(image_id: number): Promise<EditHistoryOut[]> { apiEditHistory", "description": "Lists the edit history for a specific image.", "scope": "", "scopeKind": ""}, {"name": "export async function apiListSubscriptions(): Promise<SubscriptionOut[]> { apiListSubscriptions", "description": "Lists current user subscriptions.", "scope": "", "scopeKind": ""}, {"name": "export async function apiCreateOrUpdateSubscription(plan: string): Promise<SubscriptionOut> { apiCreateOrUpdateSubscription", "description": "Creates or updates a user subscription.", "scope": "", "scopeKind": ""}, {"name": "export async function apiCreateCheckoutSession(plan: string): Promise<{ url: string }> { apiCreateCheckoutSession", "description": "Creates a Stripe checkout session for a given subscription plan.", "scope": "", "scopeKind": ""}, {"name": "export function getStripePublicKey(): string { getStripePublicKey", "description": "Returns Stripe publishable key from environment variables.", "scope": "", "scopeKind": ""}, {"name": "function clearToken() { clearToken", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function getToken(): string | null { getToken", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function setToken(token: string) { setToken", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["fetch", "localStorage.getItem", "localStorage.setItem", "localStorage.removeItem"], "search-terms": ["API client", "image upload", "subscription", "FastAPI", "JWT", "TypeScript"], "state": 2, "file_id": 12, "knowledge_revision": 71, "git_revision": "", "revision_history": [{"26": ""}, {"71": ""}], "ctags": [{"_type": "tag", "name": "API_BASE", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^const API_BASE = process.env.NEXT_PUBLIC_API_BASE_URL || \"http:\\/\\/localhost:8000\";$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "DashboardSummary", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export type DashboardSummary = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "EditHistoryOut", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export type EditHistoryOut = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "ImageOut", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export type ImageOut = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "SubscriptionOut", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export type SubscriptionOut = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "Token", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export type Token = { access_token: string; token_type?: string };$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "UsageSummary", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export type UsageSummary = { total_uploaded: number; total_edited: number; trial_remaining: numb/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "UserOut", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export type UserOut = { id: number; email: string; full_name?: string | null; is_active: boolean/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "apiCreateCheckoutSession", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export async function apiCreateCheckoutSession(plan: string): Promise<{ url: string }> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "apiCreateOrUpdateSubscription", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export async function apiCreateOrUpdateSubscription(plan: string): Promise<SubscriptionOut> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "apiDashboard", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export async function apiDashboard(): Promise<DashboardSummary> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "apiEditHistory", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export async function apiEditHistory(image_id: number): Promise<EditHistoryOut[]> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "apiGetImage", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export async function apiGetImage(image_id: number): Promise<ImageOut> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "apiListImages", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export async function apiListImages(): Promise<ImageOut[]> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "apiListSubscriptions", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export async function apiListSubscriptions(): Promise<SubscriptionOut[]> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "apiLogin", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export async function apiLogin(payload: { email: string; password: string }): Promise<Token> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "apiLogout", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export function apiLogout(): void {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "apiRegister", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export async function apiRegister(payload: { email: string; password: string; full_name?: string/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "apiRequestEdit", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export async function apiRequestEdit(image_id: number, prompt: string): Promise<EditHistoryOut> /", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "apiUploadImages", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export async function apiUploadImages(files: File[]): Promise<ImageOut[]> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "clearToken", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^function clearToken() {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "form", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^  const form = new FormData();$/", "language": "TypeScript", "kind": "constant", "scope": "apiUploadImages", "scopeKind": "function"}, {"_type": "tag", "name": "getStripePublicKey", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^export function getStripePublicKey(): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "getToken", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^function getToken(): string | null {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "headers", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^  const headers = new Headers(options.headers || {});$/", "language": "TypeScript", "kind": "constant", "scope": "request", "scopeKind": "function"}, {"_type": "tag", "name": "message", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^    const message =$/", "language": "TypeScript", "kind": "constant", "scope": "request", "scopeKind": "function"}, {"_type": "tag", "name": "request", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^async function request<T>(path: string, options: RequestInit = {}, auth = false): Promise<T> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^  const res = await fetch(`${API_BASE}${path}`, { ...options, headers });$/", "language": "TypeScript", "kind": "constant", "scope": "request", "scopeKind": "function"}, {"_type": "tag", "name": "setToken", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^function setToken(token: string) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "tok", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^    const tok = getToken();$/", "language": "TypeScript", "kind": "constant", "scope": "request", "scopeKind": "function"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^  const token = await request<Token>(\"\\/api\\/auth\\/login\", {$/", "language": "TypeScript", "kind": "constant", "scope": "apiLogin", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74006/real_estate_image_frontend/src/lib/api.ts", "pattern": "/^  const url = `\\/api\\/subscriptions\\/checkout-session?plan=${encodeURIComponent(plan)}`;$/", "language": "TypeScript", "kind": "constant", "scope": "apiCreateCheckoutSession", "scopeKind": "function"}], "hash": "76175ead21c88c45f09b835e8be0aaea", "format-version": 4, "code-base-name": "real_estate_image_frontend", "filename": "real_estate_image_frontend/src/lib/api.ts"}